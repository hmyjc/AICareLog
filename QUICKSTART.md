# å¥åº·æ¡£æ¡ˆåŠ©æ‰‹ - å¿«é€Ÿå¼€å§‹æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¥åº·æ¡£æ¡ˆåŠ©æ‰‹ç³»ç»Ÿï¼ŒåŒ…å«åç«¯APIæœåŠ¡å’Œå‰ç«¯Reactåº”ç”¨ã€‚

## ç›®å½•ç»“æ„

```
health_agent/
â”œâ”€â”€ backend/                # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/               # APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ health_profile.py  # å¥åº·æ¡£æ¡ˆç®¡ç†
â”‚   â”‚   â”œâ”€â”€ persona.py         # äººç‰©é£æ ¼ç®¡ç†
â”‚   â”‚   â””â”€â”€ push.py            # å¥åº·æ¨é€
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ config.yaml    # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ config.py      # é…ç½®åŠ è½½
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â””â”€â”€ mongodb.py     # MongoDBè¿æ¥
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ health_profile.py
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ llm_service.py     # å¤§æ¨¡å‹æœåŠ¡
â”‚   â”‚   â””â”€â”€ push_service.py    # æ¨é€æœåŠ¡
â”‚   â”œâ”€â”€ scheduler/         # å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â””â”€â”€ tasks.py
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ persona_styles.py  # äººç‰©é£æ ¼é…ç½®
â”‚   â”‚   â””â”€â”€ weather_crawler.py # å¤©æ°”çˆ¬è™«
â”‚   â””â”€â”€ app.py             # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ frontend/              # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/    # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/         # é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ProfilePage.tsx      # ç”¨æˆ·æ¡£æ¡ˆé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ PersonaPage.tsx      # äººç‰©é£æ ¼é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ RestPage.tsx         # ä½œæ¯æé†’é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ MealPage.tsx         # é¥®é£Ÿæé†’é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ WeatherPage.tsx      # å¤©æ°”æ¨é€é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ HealthTipPage.tsx    # å…»ç”Ÿå¦™æ‹›é¡µé¢
â”‚   â”‚   â”œâ”€â”€ services/      # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ store/         # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ App.tsx
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜
â””â”€â”€ QUICKSTART.md         # å¿«é€Ÿå¼€å§‹æŒ‡å—
```

## å®‰è£…æ­¥éª¤

### 1. ç¯å¢ƒè¦æ±‚

**åç«¯ï¼š**
- Python 3.8+
- pip

**å‰ç«¯ï¼š**
- Node.js 14+
- npm æˆ– yarn

### 2. åç«¯å®‰è£…

#### Windowsç³»ç»Ÿï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\PythonProject\heathy_agent\health_agent

# 2. å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# 3. é…ç½®æ•°æ®åº“
# ç¼–è¾‘ backend/config/config.yamlï¼Œç¡®è®¤MongoDBå’ŒAPIé…ç½®æ­£ç¡®

# 4. å¯åŠ¨åç«¯æœåŠ¡ï¼ˆæ–¹å¼ä¸€ï¼šä½¿ç”¨è„šæœ¬ï¼‰
start_backend.bat

# æˆ–æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
cd backend
python app.py
```

#### Linux/Macç³»ç»Ÿï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/health_agent

# 2. å®‰è£…Pythonä¾èµ–
pip3 install -r requirements.txt

# 3. é…ç½®æ•°æ®åº“
# ç¼–è¾‘ backend/config/config.yaml

# 4. å¯åŠ¨åç«¯æœåŠ¡
chmod +x start_backend.sh
./start_backend.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
cd backend
python3 app.py
```

åç«¯æœåŠ¡å°†åœ¨ `https://api.medai.medai-zjgsu.cn:8000` å¯åŠ¨

### 3. å‰ç«¯å®‰è£…

#### Windowsç³»ç»Ÿï¼š

```bash
# 1. è¿›å…¥å‰ç«¯ç›®å½•
cd D:\PythonProject\heathy_agent\health_agent\frontend

# 2. å®‰è£…pnpmï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
npm install -g pnpm

# 3. å®‰è£…ä¾èµ–
pnpm install

# 4. å¯åŠ¨å‰ç«¯ï¼ˆæ–¹å¼ä¸€ï¼šä½¿ç”¨è„šæœ¬ï¼‰
cd ..
start_frontend.bat

# æˆ–æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
cd frontend
pnpm dev
```

#### Linux/Macç³»ç»Ÿï¼š

```bash
# 1. è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# 2. å®‰è£…pnpmï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
npm install -g pnpm

# 3. å®‰è£…ä¾èµ–
pnpm install

# 4. å¯åŠ¨å‰ç«¯
chmod +x ../start_frontend.sh
../start_frontend.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
pnpm dev
```

å‰ç«¯åº”ç”¨å°†åœ¨ `https://api.medai.medai-zjgsu.cn:3000` å¯åŠ¨

## ä½¿ç”¨æµç¨‹

### 1. åˆ›å»ºå¥åº·æ¡£æ¡ˆ
1. è®¿é—® `https://api.medai.medai-zjgsu.cn:3000`
2. ç‚¹å‡»"ç”¨æˆ·æ¡£æ¡ˆ"èœå•
3. å¡«å†™åŸºç¡€ä¿¡æ¯ã€å¥åº·ä¿¡æ¯å’Œå…¶ä»–ä¿¡æ¯
4. ç‚¹å‡»"åˆ›å»ºæ¡£æ¡ˆ"æŒ‰é’®

### 2. é€‰æ‹©äººç‰©é£æ ¼
1. å®Œæˆæ¡£æ¡ˆå¡«å†™åï¼Œç‚¹å‡»"äººç‰©é£æ ¼"èœå•
2. æµè§ˆ8ç§ä¸åŒçš„æ¨é€é£æ ¼
3. ç‚¹å‡»é€‰æ‹©æ‚¨å–œæ¬¢çš„é£æ ¼

### 3. è®¾ç½®åœ°åŒºï¼ˆå¤©æ°”æ¨é€ï¼‰
1. ç‚¹å‡»"å¤©æ°”æ¨é€"èœå•
2. é€‰æ‹©æ‚¨æ‰€åœ¨çš„çœä»½å’ŒåŸå¸‚
3. ç‚¹å‡»"ä¿å­˜åœ°åŒº"

### 4. è·å–å¥åº·æ¨é€

#### ä½œæ¯æé†’
- è‡ªåŠ¨æ¨é€ï¼šæ¯å¤©7:00ã€13:00ã€23:00
- æ‰‹åŠ¨è·å–ï¼šç‚¹å‡»"ä½œæ¯æé†’"èœå•ï¼Œé€‰æ‹©æ—¶é—´æ®µè·å–

#### é¥®é£Ÿæé†’
- è‡ªåŠ¨æ¨é€ï¼šæ¯å¤©7:30ã€12:00ã€18:00
- æ‰‹åŠ¨è·å–ï¼šç‚¹å‡»"é¥®é£Ÿæé†’"èœå•ï¼Œé€‰æ‹©é¤æ¬¡è·å–

#### å¤©æ°”æ¨é€
- è‡ªåŠ¨æ¨é€ï¼šæ¯å¤©7:00ï¼ˆéœ€å…ˆè®¾ç½®åœ°åŒºï¼‰
- æ‰‹åŠ¨è·å–ï¼šç‚¹å‡»"å¤©æ°”æ¨é€"èœå•ï¼Œç‚¹å‡»"è·å–ä»Šæ—¥å¤©æ°”"

#### å…»ç”Ÿå¦™æ‹›
- è‡ªåŠ¨æ¨é€ï¼šæ¯å¤©14:00
- æ‰‹åŠ¨è·å–ï¼šç‚¹å‡»"å…»ç”Ÿå¦™æ‹›"èœå•ï¼Œç‚¹å‡»"è·å–ä»Šæ—¥å…»ç”Ÿå¦™æ‹›"

## APIæ–‡æ¡£

åç«¯å¯åŠ¨åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹å®Œæ•´APIæ–‡æ¡£ï¼š
- Swagger UI: `https://api.medai.medai-zjgsu.cn:8000/docs`
- ReDoc: `https://api.medai.medai-zjgsu.cn:8000/redoc`

## ä¸»è¦APIæ¥å£

### å¥åº·æ¡£æ¡ˆ
- `POST /api/health-profile` - åˆ›å»ºå¥åº·æ¡£æ¡ˆ
- `GET /api/health-profile/{user_id}` - è·å–å¥åº·æ¡£æ¡ˆ
- `PUT /api/health-profile/{user_id}` - æ›´æ–°å¥åº·æ¡£æ¡ˆ
- `POST /api/health-profile/{user_id}/location` - è®¾ç½®ç”¨æˆ·åœ°åŒº

### äººç‰©é£æ ¼
- `GET /api/persona-styles` - è·å–æ‰€æœ‰äººç‰©é£æ ¼
- `POST /api/persona-styles/{user_id}/select` - é€‰æ‹©äººç‰©é£æ ¼
- `GET /api/persona-styles/{user_id}/current` - è·å–å½“å‰é£æ ¼

### å¥åº·æ¨é€
- `POST /api/push/rest/{user_id}` - æ¨é€ä½œæ¯æé†’
- `POST /api/push/meal/{user_id}` - æ¨é€é¥®é£Ÿæé†’
- `POST /api/push/weather/{user_id}` - æ¨é€å¤©æ°”ä¿¡æ¯
- `POST /api/push/health-tip/{user_id}` - æ¨é€å…»ç”Ÿå¦™æ‹›
- `GET /api/push/history/{user_id}` - è·å–æ¨é€å†å²

## é…ç½®è¯´æ˜

### åç«¯é…ç½®ï¼ˆbackend/config/config.yamlï¼‰

```yaml
# é˜¿é‡Œäº‘ç™¾ç‚¼é…ç½®
dashscope:
  url: "https://dashscope.aliyuncs.com/compatible-mode/v1"
  api_key: "your-api-key"  # æ›¿æ¢ä¸ºæ‚¨çš„APIå¯†é’¥
  model: "qwen-max"

# MongoDBé…ç½®
mongodb:
  uri: "mongodb://user:password@host:port/admin"  # æ›¿æ¢ä¸ºæ‚¨çš„MongoDBè¿æ¥
  database: "arbismart"

# å®šæ—¶ä»»åŠ¡é…ç½®
scheduler:
  timezone: "Asia/Shanghai"
  rest_times: ["07:00", "13:00", "23:00"]
  meal_times: ["07:30", "12:00", "18:00"]
  weather_time: "07:00"
  health_tip_time: "14:00"
```

### å‰ç«¯é…ç½®ï¼ˆfrontend/.envï¼‰

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆæˆ–å¤åˆ¶ `.env.example`ï¼‰ï¼š

```
VITE_API_URL=https://api.medai.medai-zjgsu.cn:8000/api
```

## å¸¸è§é—®é¢˜

### 1. åç«¯å¯åŠ¨å¤±è´¥
- æ£€æŸ¥Pythonç‰ˆæœ¬æ˜¯å¦ä¸º3.8+
- æ£€æŸ¥æ‰€æœ‰ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
- æ£€æŸ¥MongoDBè¿æ¥æ˜¯å¦æ­£å¸¸
- æ£€æŸ¥8000ç«¯å£æ˜¯å¦è¢«å ç”¨

### 2. å‰ç«¯å¯åŠ¨å¤±è´¥
- æ£€æŸ¥Node.jsç‰ˆæœ¬æ˜¯å¦ä¸º14+
- åˆ é™¤node_modulesæ–‡ä»¶å¤¹ï¼Œé‡æ–°è¿è¡Œ`npm install`
- æ£€æŸ¥3000ç«¯å£æ˜¯å¦è¢«å ç”¨

### 3. APIè¯·æ±‚å¤±è´¥
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥å‰ç«¯.envæ–‡ä»¶ä¸­çš„API_URLé…ç½®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°å’Œåç«¯æ—¥å¿—

### 4. å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œ
- ç¡®è®¤åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥æ—¥å¿—ç¡®è®¤è°ƒåº¦å™¨æ˜¯å¦å¯åŠ¨
- ç¡®è®¤ç³»ç»Ÿæ—¶åŒºè®¾ç½®æ­£ç¡®

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. é¡¹ç›®README.mdæ–‡æ¡£
2. APIæ–‡æ¡£ (https://api.medai.medai-zjgsu.cn:8000/docs)
3. åç«¯æ—¥å¿—æ–‡ä»¶

## å¼€å‘å»ºè®®

- ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒç®¡ç†Pythonä¾èµ–
- å®šæœŸå¤‡ä»½MongoDBæ•°æ®åº“
- ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹é…ç½®ä¸­çš„å¯†é’¥å’Œè¿æ¥ä¿¡æ¯
- å»ºè®®ä½¿ç”¨Gitç®¡ç†ä»£ç ç‰ˆæœ¬

---

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ¥

